<main class="main">
    <div id="app-title">
        <h1>Whistle Eats</h1>
    </div>
    <div id="app-login">
        <h3>Registrate para comenzar</h3>
        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
            <label for="userType">Tipo de cuenta</label>
            <select id="userType" formControlName="userType">
                <option value="">Selecciona una opción</option>
                <option value="consumer">Consumidor</option>
                <option value="restaurant">Restaurante</option>
                <option value="delivery">Repartidor</option>
            </select>

            @if (userType() === 'consumer') {
            <div class="form-group">
                <label for="consumerName">Nombre Completo</label>
                <input type="text" id="consumerName" formControlName="consumerName" placeholder="Tu nombre">

                <label for="consumerAddress">Dirección de entrega</label>
                <input type="text" id="consumerAddress" formControlName="consumerAddress" placeholder="Dirección">

                <label for="phone">Teléfono</label>
                <input type="text" id="phone" formControlName="phone" placeholder="Teléfono"
                    title="Debe empezar por +34 seguido de 9 dígitos">
                @if (registerForm.get('phone')?.touched && registerForm.get('phone')?.errors?.['pattern']) {
                <small class="error-text">Formato inválido: +34xxxxxxxxx</small>
                }

                <label for="email">Correo electrónico</label>
                <input type="email" id="email" formControlName="email" placeholder="Correo electrónico">
                @if (registerForm.get('email')?.touched && registerForm.get('email')?.errors?.['email']) {
                <small class="error-text">Correo electrónico inválido</small>
                }

                <label for="password">Contraseña</label>
                <input type="password" id="password" formControlName="password" placeholder="Contraseña">
                @if (registerForm.get('password')?.touched &&
                registerForm.get('password')?.errors?.['passwordStrength']) {
                <small class="error-text">Min 8 caracteres, 1 mayus, 1 minus, 1 numero</small>
                }

                <label for="confirmPassword">Confirmar contraseña</label>
                <input type="password" id="confirmPassword" formControlName="confirmPassword"
                    placeholder="Confirmar contraseña">
                @if (registerForm.get('confirmPassword')?.touched &&
                registerForm.get('confirmPassword')?.errors?.['passwordMismatch']) {
                <small class="error-text">Las contraseñas no coinciden</small>
                }

                <button type="submit" [disabled]="registerForm.invalid">Registrarse</button>
            </div>
            }

            @if (userType() === 'restaurant') {
            <div class="form-group">
                <label for="restaurantName">Nombre del Restaurante</label>
                <input type="text" id="restaurantName" formControlName="restaurantName"
                    placeholder="Nombre del restaurante">

                <label for="cif">CIF</label>
                <input type="text" id="cif" formControlName="cif" placeholder="CIF del negocio">
                @if (registerForm.get('cif')?.touched && registerForm.get('cif')?.errors?.['cifInvalidFormat']) {
                <small class="error-text">Formato de CIF inválido</small>
                }
                @if (registerForm.get('cif')?.touched && registerForm.get('cif')?.errors?.['cifInvalidChecksum']) {
                <small class="error-text">El CIF no es válido</small>
                }

                <label for="restaurantAddress">Dirección del restaurante</label>
                <input type="text" id="restaurantAddress" formControlName="restaurantAddress"
                    placeholder="Dirección del restaurante">

                <label for="phone">Teléfono</label>
                <input type="text" id="phone" formControlName="phone" placeholder="Teléfono">

                <label for="email">Correo electrónico</label>
                <input type="email" id="email" formControlName="email" placeholder="Correo electrónico">

                <label for="password">Contraseña</label>
                <input type="password" id="password" formControlName="password" placeholder="Contraseña">

                <label for="confirmPassword">Confirmar contraseña</label>
                <input type="password" id="confirmPassword" formControlName="confirmPassword"
                    placeholder="Confirmar contraseña">

                <button type="submit" [disabled]="registerForm.invalid">Registrarse</button>
            </div>
            }

            @if (userType() === 'delivery') {
            <div class="form-group">
                <label for="deliveryName">Nombre Completo</label>
                <input type="text" id="deliveryName" formControlName="deliveryName" placeholder="Tu nombre">

                <label for="dni">DNI</label>
                <input type="text" id="dni" formControlName="dni" placeholder="DNI">
                @if (registerForm.get('dni')?.touched && registerForm.get('dni')?.errors?.['dniInvalidFormat']) {
                <small class="error-text">Formato de DNI inválido (12345678A)</small>
                }
                @if (registerForm.get('dni')?.touched && registerForm.get('dni')?.errors?.['dniInvalidLetter']) {
                <small class="error-text">La letra del DNI es incorrecta</small>
                }

                <label for="phone">Teléfono</label>
                <input type="text" id="phone" formControlName="phone" placeholder="Teléfono">

                <label for="email">Correo electrónico</label>
                <input type="email" id="email" formControlName="email" placeholder="Correo electrónico">

                <label for="password">Contraseña</label>
                <input type="password" id="password" formControlName="password" placeholder="Contraseña">

                <label for="confirmPassword">Confirmar contraseña</label>
                <input type="password" id="confirmPassword" formControlName="confirmPassword"
                    placeholder="Confirmar contraseña">

                <label for="vehicleType">Tipo de vehiculo</label>
                <select id="vehicleType" formControlName="vehicleType">
                    <option value="">Selecciona opción</option>
                    <option value="bicicleta">Bici</option>
                    <option value="moto">Moto</option>
                    <option value="coche">Coche</option>
                </select>

                @if (vehicleType() === 'moto' || vehicleType() === 'coche') {
                <label for="vehiclePlate">Matricula</label>
                <input type="text" id="vehiclePlate" formControlName="vehiclePlate" placeholder="1234BBB">
                @if (registerForm.get('vehiclePlate')?.touched && registerForm.get('vehiclePlate')?.errors?.['pattern'])
                {
                <small class="error-text">Formato inválido: 1234BBB</small>
                }

                <label for="vehicleBrand">Marca</label>
                <input type="text" id="vehicleBrand" formControlName="vehicleBrand" placeholder="Marca">

                <label for="vehicleModel">Modelo</label>
                <input type="text" id="vehicleModel" formControlName="vehicleModel" placeholder="Modelo">

                <label for="vehicleColor">Color</label>
                <input type="text" id="vehicleColor" formControlName="vehicleColor" placeholder="Color">

                <label for="drivingLicense">Carnet de conducir</label>
                <input type="text" id="drivingLicense" formControlName="drivingLicense" placeholder="12365177 - G">
                <small class="help-text">Casilla número 5 del anverso del permiso</small>
                }

                <button type="submit" [disabled]="registerForm.invalid">Registrarse</button>
            </div>
            }
        </form>
    </div>
    <div style="margin-top: 1rem; text-align: center;">
        <p>¿Ya tienes cuenta? <a [routerLink]="['/login']"
                style="color: #ff9800; text-decoration: none; font-weight: 600; cursor: pointer;">Inicia sesión</a></p>
    </div>
</main>