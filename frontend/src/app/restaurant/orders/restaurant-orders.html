<main class="main">
    <div class="header">
        <h1>Pedidos Recibidos</h1>
        <div class="actions">
            <button class="refresh-btn" (click)="refreshOrders()" [disabled]="loading">üîÑ Actualizar</button>
            <a routerLink="/restaurant" class="back-btn">‚Üê Volver</a>
        </div>
    </div>

    <div class="orders-container">
        @if (loading) {
        <div class="loading">Cargando pedidos...</div>
        } @else {
        @for (order of orders; track order.id) {
        <div class="order-card">
            <div class="order-header">
                <span class="order-id">#{{ order.id.slice(0, 8) }}</span>
                <span class="order-status" [class]="order.status">{{ order.status }}</span>
                <span class="order-date">{{ order.created_at | date:'short' }}</span>
            </div>
            <div class="order-details">
                <p><strong>Cliente:</strong> {{ order.clientName }}</p>
                <p><strong>Direcci√≥n:</strong> {{ order.deliveryAddress }} via {{ order.driverid_id ? 'Driver Asignado'
                    : 'Sin Asignar' }}</p>
            </div>
            <div class="order-items">
                <ul>
                    @for (item of order.items; track item.id) {
                    <li>{{ item.quantity }}x {{ item.product.name }} - {{ item.subtotal }}‚Ç¨</li>
                    }
                </ul>
            </div>
            <div class="order-footer">
                <div class="verification-section">
                    <input type="text" [(ngModel)]="order.verificationCode" placeholder="C√≥digo (4 d√≠gitos)"
                        maxlength="4" class="code-input">
                    <button class="verify-btn" (click)="verifyOrder(order)">Verificar</button>
                </div>
                <strong>Total: {{ order.totalamount | number:'1.2-2' }}‚Ç¨</strong>
            </div>
        </div>
        } @empty {
        <div class="no-orders">
            <p>No hay pedidos registrados.</p>
        </div>
        }
        }
    </div>
</main>