<main class="main">
    <div id="app-title">
        <h1>Whistle Eats</h1>
    </div>
    <div id="restaurant">
        <h2>{{ restaurantName }}</h2>
        <h3>{{ restaurantAddress }}</h3>
        <div class="stars">
            @if(restaurantStars >= 1){
            <span class="star filled">★</span>
            }@else{
            <span class="star">★</span>
            }
            @if(restaurantStars >= 2){
            <span class="star filled">★</span>
            }@else{
            <span class="star">★</span>
            }
            @if(restaurantStars >= 3){
            <span class="star filled">★</span>
            }@else{
            <span class="star">★</span>
            }
            @if(restaurantStars >= 4){
            <span class="star filled">★</span>
            }@else{
            <span class="star">★</span>
            }
            @if(restaurantStars >= 5){
            <span class="star filled">★</span>
            }@else{
            <span class="star">★</span>
            }
        </div>
    </div>
    <div id="products-title">
        <h3>Tus productos</h3>
    </div>
    <div id="products">
        <div id="product-filter">
            <div id="product-filter-search">
                <input #searchInput id="searchProduct-input" type="text" placeholder="Buscar producto"
                    (input)="searchProduct = searchInput.value; productType = 'all'">
            </div>
            <div id="product-filter-types">
                <button (click)="productType = 'all'; searchProduct = ''; searchInput.value = ''"
                    [class.active]="productType == 'all'">Todos</button>
                <button (click)="productType = 'menu'; searchProduct = ''; searchInput.value = ''"
                    [class.active]="productType == 'menu'">Menú</button>
                <button (click)="productType = 'comida'; searchProduct = ''; searchInput.value = ''"
                    [class.active]="productType == 'comida'">Comida</button>
                <button (click)="productType = 'bebida'; searchProduct = ''; searchInput.value = ''"
                    [class.active]="productType == 'bebida'">Bebida</button>
                <button (click)="productType = 'complemento'; searchProduct = ''; searchInput.value = ''"
                    [class.active]="productType == 'complemento'">Complemento</button>
            </div>
        </div>
        @for (product of products; track product.id) {
        @if((productType == 'all' || productType == product.type) && (!searchProduct ||
        product.name?.toLowerCase()?.includes(searchProduct.toLowerCase()))){
        <div class="product-item">
            <div id="product">
                <div id="texts">
                    <h4 class="product-title">{{ product.name }}</h4>
                    <p class="product-price">{{ product.price }}€</p>
                    <p class="product-description">{{ product.description }}</p>
                </div>
                <div class="product-image-wrapper">
                    <a class="image"><img [src]="product.imageurl || 'images/cangreburger.png'"
                            [alt]="product.name"></a>
                    <button class="edit"><img src="images/edit.png" alt="Editar"></button>
                </div>
            </div>
            <hr>
        </div>
        }
        } @empty {
        <p style="text-align: center; margin: 20px;">No hay productos disponibles.</p>
        }
    </div>

    @if (showAddForm) {
    <div class="add-product-form" style="margin: 20px; padding: 20px; border: 1px solid #ddd; border-radius: 8px;">
        <h4>Añadir nuevo producto</h4>
        <form [formGroup]="productForm" (ngSubmit)="onAddProduct()">
            <div style="margin-bottom: 10px;">
                <input type="text" formControlName="name" placeholder="Nombre del producto"
                    style="width: 100%; padding: 8px;">
            </div>
            <div style="margin-bottom: 10px;">
                <textarea formControlName="description" placeholder="Descripción"
                    style="width: 100%; padding: 8px;"></textarea>
            </div>
            <div style="margin-bottom: 10px;">
                <input type="number" formControlName="price" placeholder="Precio" step="0.01"
                    style="width: 100%; padding: 8px;">
            </div>
            <div style="margin-bottom: 10px;">
                <input type="text" formControlName="imageUrl" placeholder="URL de la imagen"
                    style="width: 100%; padding: 8px;">
            </div>
            <button type="submit" [disabled]="productForm.invalid"
                style="padding: 8px 16px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">Guardar</button>
        </form>
    </div>
    }

    <div class="add">
        <button class="add-product" (click)="toggleAddForm()">+</button>
    </div>

</main>